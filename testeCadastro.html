<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Include the Dark theme -->
    <link rel="stylesheet" href="@sweetalert2/theme-dark/dark.css">

    <script src="sweetalert2/dist/sweetalert2.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/testeCadastro.css ">
    <title>Cadastro - Sisguard</title>
</head>

<body>
    <div class="banner">
        <div class="container">
            <div class="cabecalho">
                <div class="destaque">Cadastro</div>
                <div class="linha"></div>
                <div><a class="sel" href="testeLogin.html">Login</a></div>
            </div>

            <div class="conteiner2">
                <div class="caixa1">
                    <div class="container3">
                        <h1>Bem vindo!</h1><br><br>


                        <h2>Preencha e se torne parte da equipe Sisguard</h2><br><br><br>


                        <span class="texto">Um site desenvolvido para quem se importa desde o core</span>
                    </div>
                </div>
                <div class="caixa2">
                    <div class="nomeSobrenome">
                        <div class="caixa">
                            Nome <br>
                            <input class="input" type="text" id="nome_input">
                        </div>
                        <div class="caixa">
                            CNPJ <br>
                            <input class="input" type="number" id="sobrenome_input">
                        </div>
                    </div>

                    <div class="email">
                        <div class="caixaemail">
                            Email <br>
                            <input class="inputgrande" type="email" id="email_input">
                        </div>
                    </div>

                    <div class="senha">
                        <div class="caixasenha">
                            Senha <br>
                            <input class="input" type="password" id="senha_input">
                        </div>
                        <div class="caixasenha">
                            Confirme a Senha <br>
                            <input class="input" type="password" id="confirme_input">
                        </div>
                    </div>

                    <div class="caixabutton">
                        <button onclick="cadastrar()" class="button">Cadastrar</button>
                        <button class="button2"><a href="index.html">Voltar</a></button>
                    </div>

                </div>
            </div>

        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="script.js"></script>
    <script>
        const cadastrar = () => {
            let nome = nome_input.value
            let cnpj = sobrenome_input.value
            let email = email_input.value
            let senha = senha_input.value
            let confirmar = confirme_input.value
            let dados = {}

            if (nome === '' || email === '' || cnpj === '' || senha === '' || confirmar === '') {
                Swal.fire({
                    icon: "error",
                    title: "Oops...",
                    text: "Preencha todos os campos",
                });
                return false
            } else if (senha.length < 8) {
                Swal.fire({
                    color: "white",
                    background: "black",
                    icon: "warning",
                    title: "Oops...",
                    text: "Senha tem que ser maior que 8",
                });
                return false
            } else if (senha != confirmar) {
                Swal.fire({
                    color: "white",
                    background: "black",
                    icon: "warning",
                    title: "Oops...",
                    text: "As senhas precisam ser iguais",
                });
                return false
            } else if (!email.endsWith(".com")) {
                Swal.fire({
                    color: "white",
                    background: "black",
                    icon: "warning",
                    title: "Oops...",
                    text: "E-mail tem que terminar com '.com'",
                });
                return false
            } else if (cnpj.length < 14) {
                alert("Cnpj tem que ser 14")
                return false
            } else {
                dados = {
                    nome,
                    email,
                    cnpj,
                    senha
                }

                fetch(`http://localhost:3000/cadastro`, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(dados)
                }).then(function (resposta) {
                    if (dados) {
                        Swal.fire({
                            position: "top-end",
                            icon: "success",
                            title: "Your work has been saved",
                            showConfirmButton: false,
                            timer: 1500
                        });
                    } else {
                        alert('Cadastro deu ruim')
                    }
                }).catch(erro => console.log(erro))
            }
        }
    </script>
</body>

</html>